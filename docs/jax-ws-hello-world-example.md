# JAX-WS Hello World 示例 RPC 风格

> 原文：<http://web.archive.org/web/20230101150211/https://mkyong.com/webservices/jax-ws/jax-ws-hello-world-example/>

JAX-WS 与 JDK 1.6 捆绑在一起，这使得 Java web 服务开发更容易开发。本教程向您展示了如何执行以下任务:

1.  使用 JAX-WS 创建一个基于 SOAP 的 RPC 样式的 web 服务端点。
2.  手动创建 Java web 服务客户端。
3.  通过 **wsimport** 工具创建一个 Java web 服务客户端。
4.  创建一个 Ruby web 服务客户端。

你会惊奇地发现在 JAX WS 中开发一个 RPC 样式 web 服务是多么简单。

**Note**
In general words, “*web service endpoint*” is a service which published outside for user to access; where “*web service client*” is the party who access the published service.

## JAX-WS Web 服务端点

以下步骤显示了如何使用 JAX-WS 来创建 RPC 样式的 web 服务端点。

freestar.config.enabled_slots.push({ placementName: "mkyong_incontent_1", slotId: "mkyong_incontent_1" });

## 1.创建 Web 服务端点接口

*文件:HelloWorld.java*

```java
 package com.mkyong.ws;

import javax.jws.WebMethod;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;
import javax.jws.soap.SOAPBinding.Style;

//Service Endpoint Interface
@WebService
@SOAPBinding(style = Style.RPC)
public interface HelloWorld{

	@WebMethod String getHelloWorldAsString(String name);

} 
```

## 2.创建 Web 服务端点实现

*文件:HelloWorldImpl.java*

```java
 package com.mkyong.ws;

import javax.jws.WebService;

//Service Implementation
@WebService(endpointInterface = "com.mkyong.ws.HelloWorld")
public class HelloWorldImpl implements HelloWorld{

	@Override
	public String getHelloWorldAsString(String name) {
		return "Hello World JAX-WS " + name;
	}

} 
```

## 3.创建端点发布者

*文件:HelloWorldPublisher.java*

```java
 package com.mkyong.endpoint;

import javax.xml.ws.Endpoint;
import com.mkyong.ws.HelloWorldImpl;

//Endpoint publisher
public class HelloWorldPublisher{

	public static void main(String[] args) {
	   Endpoint.publish("http://localhost:9999/ws/hello", new HelloWorldImpl());
    }

} 
```

运行端点发布器，您的“ **hello world web 服务**部署在 URL“**http://localhost:9999/ws/hello**”中。

## 4.测试一下

您可以通过这个 URL "**http://localhost:9999/ws/hello？wsdl** ”。

## Web 服务客户端

好了，web 服务已正确部署，现在让我们看看如何创建 web 服务客户端来访问已发布的服务。

## 1.Java Web 服务客户端

无需工具，您可以创建一个 Java web 服务客户端，如下所示:

```java
 package com.mkyong.client;

import java.net.URL;
import javax.xml.namespace.QName;
import javax.xml.ws.Service;
import com.mkyong.ws.HelloWorld;

public class HelloWorldClient{

	public static void main(String[] args) throws Exception {

	URL url = new URL("http://localhost:9999/ws/hello?wsdl");

        //1st argument service URI, refer to wsdl document above
	//2nd argument is service name, refer to wsdl document above
        QName qname = new QName("http://ws.mkyong.com/", "HelloWorldImplService");

        Service service = Service.create(url, qname);

        HelloWorld hello = service.getPort(HelloWorld.class);

        System.out.println(hello.getHelloWorldAsString("mkyong"));

    }

} 
```

*输出*

```java
 Hello World JAX-WS mkyong 
```

## 2.通过 wsimport 工具的 Java Web 服务客户端

或者，您可以使用" **wsimport** 工具来解析发布的 wsdl 文件，并生成必要的客户端文件(存根)来访问发布的 web 服务。

**Where is wsimport?**
This **wsimport** tool is bundle with the JDK, you can find it at “*JDK_PATH/bin*” folder.

发出“ **wsimport** 命令。

```java
 wsimport -keep http://localhost:9999/ws/hello?wsdl 
```

它将生成必要的客户端文件，这取决于所提供的 wsdl 文件。在这种情况下，它将生成一个接口和一个服务实现文件。

*文件:HelloWorld.java*

```java
 package com.mkyong.ws;

import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;

/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.1.1 in JDK 6
 * Generated source version: 2.1
 * 
 */
@WebService(name = "HelloWorld", targetNamespace = "http://ws.mkyong.com/")
@SOAPBinding(style = SOAPBinding.Style.RPC)
public interface HelloWorld {

    /**
     * 
     * @param arg0
     * @return
     *     returns java.lang.String
     */
    @WebMethod
    @WebResult(partName = "return")
    public String getHelloWorldAsString(
        @WebParam(name = "arg0", partName = "arg0")
        String arg0);

} 
```

*文件:HelloWorldImplService.java*

```java
 package com.mkyong.ws;

import java.net.MalformedURLException;
import java.net.URL;
import javax.xml.namespace.QName;
import javax.xml.ws.Service;
import javax.xml.ws.WebEndpoint;
import javax.xml.ws.WebServiceClient;
import javax.xml.ws.WebServiceFeature;

/**
 * This class was generated by the JAX-WS RI.
 * JAX-WS RI 2.1.1 in JDK 6
 * Generated source version: 2.1
 * 
 */
@WebServiceClient(name = "HelloWorldImplService", 
	targetNamespace = "http://ws.mkyong.com/", 
	wsdlLocation = "http://localhost:9999/ws/hello?wsdl")
public class HelloWorldImplService
    extends Service
{

    private final static URL HELLOWORLDIMPLSERVICE_WSDL_LOCATION;

    static {
        URL url = null;
        try {
            url = new URL("http://localhost:9999/ws/hello?wsdl");
        } catch (MalformedURLException e) {
            e.printStackTrace();
        }
        HELLOWORLDIMPLSERVICE_WSDL_LOCATION = url;
    }

    public HelloWorldImplService(URL wsdlLocation, QName serviceName) {
        super(wsdlLocation, serviceName);
    }

    public HelloWorldImplService() {
        super(HELLOWORLDIMPLSERVICE_WSDL_LOCATION, 
			new QName("http://ws.mkyong.com/", "HelloWorldImplService"));
    }

    /**
     * 
     * @return
     *     returns HelloWorld
     */
    @WebEndpoint(name = "HelloWorldImplPort")
    public HelloWorld getHelloWorldImplPort() {
        return (HelloWorld)super.getPort(
			new QName("http://ws.mkyong.com/", "HelloWorldImplPort"), 
			HelloWorld.class);
    }

    /**
     * 
     * @param features
     *  A list of {@link javax.xml.ws.WebServiceFeature} to configure on the proxy.  
     *  Supported features not in the <code>features</code> parameter will have their default values.
     * @return
     *  returns HelloWorld
     */
    @WebEndpoint(name = "HelloWorldImplPort")
    public HelloWorld getHelloWorldImplPort(WebServiceFeature... features) {
        return (HelloWorld)super.getPort(
			new QName("http://ws.mkyong.com/", "HelloWorldImplPort"), 
			HelloWorld.class, 
			features);
    }

} 
```

现在，创建一个依赖于上面生成的文件的 Java web 服务客户机。

```java
 package com.mkyong.client;

import com.mkyong.ws.HelloWorld;
import com.mkyong.ws.HelloWorldImplService;

public class HelloWorldClient{

	public static void main(String[] args) {

		HelloWorldImplService helloService = new HelloWorldImplService();
		HelloWorld hello = helloService.getHelloWorldImplPort();

		System.out.println(hello.getHelloWorldAsString("mkyong"));

    }

} 
```

这是输出

```java
 Hello World JAX-WS mkyong 
```

## 3.Ruby Web 服务客户端

web 服务开发经常与其他编程语言混合使用。所以，这里有一个 Ruby web 服务客户端的例子，它被用来访问已发布的 JAX-WS 服务。

```java
# package for SOAP-based services
require 'soap/wsdlDriver'

wsdl_url = 'http://localhost:9999/ws/hello?wsdl'

service = SOAP::WSDLDriverFactory.new(wsdl_url).create_rpc_driver

# Invoke service operations.
data1 = service.getHelloWorldAsString('mkyong')

# Output results.
puts "getHelloWorldAsString : #{data1}"

```

输出

```java
 getHelloWorldAsString : Hello World JAX-WS mkyong 
```

## 跟踪 SOAP 流量

从上到下，展示了 SOAP 信封如何在客户机和服务器之间流动。再次参见#1 web 服务客户端:

```java
 URL url = new URL("http://localhost:9999/ws/hello?wsdl");
    QName qname = new QName("http://ws.mkyong.com/", "HelloWorldImplService");
    Service service = Service.create(url, qname);

    HelloWorld hello = service.getPort(HelloWorld.class);

    System.out.println(hello.getHelloWorldAsString("mkyong")); 
```

**Note**
To monitor SOAP traffic is very easy, see this guide – “[How to trace SOAP message in Eclipse IDE](http://web.archive.org/web/20210131115500/http://www.mkyong.com/webservices/jax-ws/how-to-trace-soap-message-in-eclipse-ide/)“.

## 1.申请一份 WSDL 档案

首先，客户端向服务端点发送 wsdl 请求，请参见下面的 HTTP 流量:

**客户端发送请求:**

```java
 GET /ws/hello?wsdl HTTP/1.1
User-Agent: Java/1.6.0_13
Host: localhost:9999
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive 
```

**服务器发送响应:**

```java
 HTTP/1.1 200 OK
Transfer-encoding: chunked
Content-type: text/xml;charset=utf-8

<?xml version="1.0" encoding="UTF-8"?>

<definitions 
	xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 
	xmlns:tns="http://ws.mkyong.com/" 
	xmlns:xsd="http://www.w3.org/2001/XMLSchema" 

	targetNamespace="http://ws.mkyong.com/" 
	name="HelloWorldImplService">

	<types></types>

<message name="getHelloWorldAsString">
	<part name="arg0" type="xsd:string"></part>
</message>
<message name="getHelloWorldAsStringResponse">
	<part name="return" type="xsd:string"></part>
</message>

<portType name="HelloWorld">
	<operation name="getHelloWorldAsString" parameterOrder="arg0">
		<input message="tns:getHelloWorldAsString"></input>
		<output message="tns:getHelloWorldAsStringResponse"></output>
	</operation>
</portType>

<binding name="HelloWorldImplPortBinding" type="tns:HelloWorld">

	<soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="rpc"></soap:binding>
	<operation name="getHelloWorldAsString">
		<soap:operation soapAction=""></soap:operation>
		<input>
			<soap:body use="literal" namespace="http://ws.mkyong.com/"></soap:body>
		</input>
		<output>
			<soap:body use="literal" namespace="http://ws.mkyong.com/"></soap:body>
		</output>
	</operation>

</binding>

<service name="HelloWorldImplService">
<port name="HelloWorldImplPort" binding="tns:HelloWorldImplPortBinding">
<soap:address location="http://localhost:9999/ws/hello"></soap:address>
</port>
</service>
</definitions> 
```

## 2.hello.getHelloWorldAsString()

第二次调用，客户端将方法调用请求放入 SOAP 信封，并将其发送到服务端点。在服务端点，调用请求的方法，将结果放入 SOAP 信封，并将其发送回客户端。

**客户端发送请求:**

```java
 POST /ws/hello HTTP/1.1
SOAPAction: ""
Accept: text/xml, multipart/related, text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Content-Type: text/xml; charset=utf-8
User-Agent: Java/1.6.0_13
Host: localhost:9999
Connection: keep-alive
Content-Length: 224

<?xml version="1.0" ?>
	<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
		<S:Body>
			<ns2:getHelloWorldAsString xmlns:ns2="http://ws.mkyong.com/">
				<arg0>mkyong</arg0>
			</ns2:getHelloWorldAsString>
		</S:Body>
	</S:Envelope> 
```

**服务器发送响应:**

```java
 HTTP/1.1 200 OK
Transfer-encoding: chunked
Content-type: text/xml; charset=utf-8

<?xml version="1.0" ?>
	<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
		<S:Body>
			<ns2:getHelloWorldAsStringResponse xmlns:ns2="http://ws.mkyong.com/">
				<return>Hello World JAX-WS mkyong</return>
			</ns2:getHelloWorldAsStringResponse>
		</S:Body>
	</S:Envelope> 
```

完成，任何意见，不胜感激。

## 下载源代码

Download It – [JAX-WS-HelloWorld-RPC-Example.zip](http://web.archive.org/web/20210131115500/http://www.mkyong.com/wp-content/uploads/2010/11/JAX-WS-HelloWorld-RPC-Example.zip) (14KB)Tags : [hello world](http://web.archive.org/web/20210131115500/https://mkyong.com/tag/hello-world/) [jax-ws](http://web.archive.org/web/20210131115500/https://mkyong.com/tag/jax-ws/) [web services](http://web.archive.org/web/20210131115500/https://mkyong.com/tag/web-services/)freestar.config.enabled_slots.push({ placementName: "mkyong_leaderboard_btf", slotId: "mkyong_leaderboard_btf" });<input type="hidden" id="mkyong-current-postId" value="7699">